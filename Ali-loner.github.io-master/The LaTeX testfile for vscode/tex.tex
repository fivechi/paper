\documentclass[a4paper]{report} %draft:显示空白页，final:显示图片
\usepackage[utf8]{inputenc}
\usepackage[margin=1.25in]{geometry}
\usepackage[UTF8]{ctex} % 中文支持
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tabularx} % 自适应宽度表格
\usepackage{array}    % 表格格式增强
\usepackage{booktabs} % 更漂亮的横线
\usepackage{hyperref}
\usepackage{amsmath, amssymb} % 数学符号支持
\usepackage{bm} % 粗体数学符号
\usepackage{graphicx} %插入图片的宏包
\usepackage{float} %设置图片浮动位置的宏包
\usepackage{subcaption}
\usepackage{enumitem}
% \renewcommand{\bibname}{} % 去掉参考文献标题

\hypersetup{
    colorlinks=true,
    linkcolor=black,
    filecolor=magenta,
    urlcolor=cyan
}

\newcommand{\enabstractname}{Abstract}
\newcommand{\cnabstractname}{摘要}
\newenvironment{enabstract}{%
  \par\Large
  \noindent\mbox{}\hfill{\bfseries \enabstractname}\hfill\mbox{}\par
  \vskip 2.5ex}{\par\vskip 2.5ex}
\newenvironment{cnabstract}{%
  \par\Large
  \noindent\mbox{}\hfill{\bfseries \cnabstractname}\hfill\mbox{}\par
  \vskip 2.5ex}{\par\vskip 2.5ex}

\definecolor{codegray}{gray}{0.98}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{codegray},   
    commentstyle=\color{gray},
    keywordstyle=\color{blue},
    numberstyle=\tiny\color{gray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\small,
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=4
}
\lstset{style=mystyle, language=Python}

\setcounter{tocdepth}{1} 

\title{title}
\author{}
\date{\today}

%% 正文开始
\begin{document}
\maketitle

\begin{cnabstract}
\large
  
热力学基本规律在宏观体系中已得到广泛验证，但其在微观尺度下的适用性仍需深入探讨。
该实验从微观粒子的热运动出发，以布朗运动为典型模型，结合实验与理论分析，通过测量布朗粒子的随机位移行为，验证不可逆过程中的熵产生机制。
进一步地，我们建立了布朗运动中扩散系数与熵产生之间的热力学不确定关系，揭示了微观热运动背后的统计规律及其与热力学第二定律的一致性。
该实验研究为从微观尺度验证热力学基本规律提供了有效途径，并对理解非平衡态下微观体系的热力学行为具有重要意义。

\par\textbf{关键字: } 布朗运动，熵产生率，热力学不确定关系
\end{cnabstract}

\newpage
\begin{enabstract}
\large
The basic laws of thermodynamics have been widely verified in the macro system, but its applicability at the micro scale still needs to be further explored.
Based on the thermal motion of microscopic particles, this experiment takes Brownian motion as a typical model, combines experiments and theoretical analysis, and verifies the entropy generation mechanism in the irreversible process by measuring the random displacement behavior of Brownian particles.
Furthermore, we establish the thermodynamic uncertainty relationship between diffusion coefficient and entropy generation in Brownian motion, and reveal the statistical law behind microscopic thermal motion and its consistency with the second law of thermodynamics.
This experimental study provides an effective way to verify the basic laws of thermodynamics from the micro-scale, and is of great significance to understand the thermodynamic behavior of micro-systems in non-equilibrium state. 

\end{enabstract}

\tableofcontents

\chapter{实验背景与目的}
\section{实验背景}

\subsection{布朗运动}
布朗运动（Brownian Motion）是悬浮在流体中的微小粒子所表现出的不规则、无规则的随机运动现象。该现象最早由植物学家布朗（Robert Brown）在1827年发现 \cite{brown1828}. 
在统计物理的框架下，布朗运动被视为粒子与流体分子不断碰撞的结果，是连接微观热力学与宏观扩散过程的重要桥梁。爱因斯坦在1905年通过理论分析给出了布朗运动的定量描述，将其与扩散系数联系起来，
并为分子理论提供了实验证据 \cite{einstein1905}。
\subsection{扩散系数}
扩散系数（Diffusion Coefficient）是描述粒子随机运动强度的重要物理量，常用 $D$ 表示。在一维情况下，粒子的均方位移满足关系：
\begin{equation}
\langle x^2(t) \rangle = 2Dt,
\end{equation}
其中 $\langle x^2(t) \rangle$ 为粒子在时间 $t$ 内的均方位移 \cite{uhlenbeck1930}. 该公式揭示了扩散过程与时间的线性关系，同时也表明扩散系数与粒子所处介质的黏度以及温度密切相关。
根据爱因斯坦关系式，扩散系数可表示为：
\begin{equation}
D = \frac{k_B T}{\gamma},
\end{equation}
其中 $k_B$ 为玻尔兹曼常数，$T$ 为系统温度，$\gamma$ 为摩擦系数。该关系式为实验测量扩散系数与温度、黏性阻力之间的联系提供了理论基础。

\subsection{热学中的噪声理论}
在热学体系中，噪声起源于热涨落，是粒子与周围分子相互作用的直接体现。朗之万（Langevin）于1908年提出了描述布朗运动的随机动力学方程，即朗之万方程：
\begin{equation}
m \frac{dv}{dt} = -\gamma v + \xi(t),
\end{equation}
其中 $m$ 为粒子质量，$\gamma$ 为阻尼系数，$\xi(t)$ 为随机力，通常满足：
\begin{equation}
\langle \xi(t) \rangle = 0, \quad \langle \xi(t)\xi(t') \rangle = 2k_B T \gamma \delta(t-t').
\end{equation}
上述相关函数体现了热噪声的高斯白噪声特性 \cite{kubo1966}. 该理论不仅解释了布朗运动中的速度涨落与热平衡的关系，而且奠定了现代随机过程与噪声理论在统计物理和热学研究中的基础。

\subsection{小结}
综上所述，布朗运动、扩散系数以及热噪声理论三者之间存在紧密联系。通过实验对布朗运动的观测与扩散系数的测定，可以深入理解微观粒子的动力学行为，并验证统计物理与热力学理论。
\section{实验目的}
本实验旨在构建一个由可控电噪声驱动的胶体布朗粒子系统，实现从平衡态到非平衡态的连续过渡，为深入研究非平衡统计物理中的基本问题提供理想实验平台。
通过系统探究扩散行为的重构机制、有效温度的涌现规律以及熵产生率的定量估计，本研究致力于揭示非平衡驱动力对微观动力学行为的调控作用，
进而深化对远离平衡态系统中能量耗散、热化过程及非平衡稳态形成机制的理解。

\chapter{实验原理}
实验原理的推导工作主要围绕布朗粒子在外部随机驱动下的有效动能温度与扩散特性展开。\par
首先，在\textbf{有效动能温度公式推导}中，通过朗之万方程出发，分析了热噪声与附加随机噪声的共同作用。
结果表明，外加噪声项会等效提高粒子的动能温度，给出修正后的公式
\[
T_{\text{kin}} = T_w + \frac{\sigma^2}{2k\gamma},
\]
其中温度增量正比于噪声强度的平方，反比于阻尼系数。这一结论直接刻画了外部驱动对系统非平衡涨落的影响，
与实验研究中利用附加噪声调控布朗粒子温度的思路相吻合 \cite{Martinez2013,Roldan2014}。\par
随后，在\textbf{噪声强度与扩散系数的修正关系}部分，从过阻尼朗之万方程出发，将外部噪声纳入扩散系数的定义，得到
\[
D = \frac{k_B T_w}{\gamma} + \frac{\sigma^2}{2\gamma^2} = \mu k_B T_w + \frac{\sigma^2 \mu^2}{2},
\]
其中 $\mu = 1/\gamma$ 为迁移率。该结果揭示了非热噪声会额外贡献一个正的扩散项，从而改变系统的弛豫与熵产生率的下界估计。结合近期提出的熵产生率推导框架 \cite{Leighton2024}，
这一修正有助于在广义随机热力学下刻画非平衡驱动的系统。\par
综上，本部分推导的目的在于建立一个统一的描述：通过在动能温度和扩散系数中引入外部随机力修正项，可以更准确地刻画布朗体系在非平衡条件下的动力学特征。
这既为实验测量与调控提供了理论依据 \cite{Martinez2013,Roldan2014}，也与最新的熵产生率界限理论 \cite{Leighton2024} 相呼应。

\section{有效动能温度公式推导}

在研究布朗粒子非平衡涨落性质时，一个核心问题是如何合理地定义和刻画粒子的\textbf{有效动能温度}。
当粒子被光阱约束时，其运动可由朗之万方程描述。为了突出外部噪声对动能涨落的影响，这里采用自由粒子近似，忽略势能项。
动力学方程写为
\begin{equation}
m \frac{dv}{dt} = -\gamma v + \xi(t) + \zeta(t),
\end{equation}
其中摩擦力 $-\gamma v$ 描述粒子与流体环境之间的黏滞阻尼，$\xi(t)$ 是来自热浴的随机噪声，对应环境温度 $T_w$，
而 $\zeta(t)$ 表示由外加电场或其他方式引入的外部随机力，幅值为 $\sigma$。  
对于噪声项，通常假设其为高斯白噪声，具有零均值和 $\delta$ 相关性质。热噪声满足
\begin{equation}
\langle \xi(t) \xi(t') \rangle = 2\gamma k_B T_w \delta(t - t'),
\end{equation}
而外部随机力的相关函数为
\begin{equation}
\langle \zeta(t) \zeta(t') \rangle = \sigma^2 \delta(t - t'),
\end{equation}
二者相互独立，因此互相关为零。 \par 

定义总噪声 $\eta(t) = \xi(t) + \zeta(t)$，其统计特性可写为
\begin{equation}
\langle \eta(t)\eta(t') \rangle = \big( 2\gamma k_B T_w + \sigma^2 \big)\delta(t - t').
\end{equation}
这表明外部噪声的引入相当于在热噪声的基础上增加了一项有效的能量输入，从而改变系统的温度特征。  

朗之万方程的稳态解为
\begin{equation}
v(t) = \frac{1}{m} \int_{-\infty}^{t} e^{-\frac{\gamma}{m}(t-\tau)} \eta(\tau) \, d\tau,
\end{equation}
通过对其方差进行计算，可得
\begin{equation}
\langle v^2 \rangle = \frac{2\gamma k_B T_w + \sigma^2}{2\gamma m}.
\end{equation}

根据能量均分定理，动能与有效动能温度的关系为
\begin{equation}
\frac{1}{2} m \langle v^2 \rangle = \frac{1}{2} k_B T_{\text{kin}},
\end{equation}
代入上式便得到修正后的有效温度
\begin{equation}
T_{\text{kin}} = T_w + \frac{\sigma^2}{2k_B \gamma}.
\label{eq:Teff}
\end{equation}\par
这一结果揭示：\textbf{外部随机力会等效提高布朗粒子的有效动能温度}。其增加量与噪声强度平方 $\sigma^2$ 成正比，与摩擦系数 $\gamma$ 成反比。
这一现象已在实验中得到验证，例如 Martínez 等 \cite{Martinez2013} 利用电场噪声显著提高了布朗球的动能温度，Roldán 等 \cite{Roldan2014}
进一步将其应用于非平衡过程的能量测量。上述理论公式为理解和解释这些实验结果提供了坚实的基础。
\section{噪声强度与扩散系数的修正关系}\par

除了动能温度，外部随机力还会显著影响布朗粒子的扩散行为。为此，我们转而考虑过阻尼近似下的朗之万方程：
\begin{equation}
\gamma \dot{x} = f(x,t) + \eta(t),
\end{equation}
其中 $\eta(t)$ 的相关函数包含了热噪声和外部噪声的贡献：
\begin{equation}
\langle \eta(t)\eta(t') \rangle = \big( 2\gamma k_B T_w + \sigma^2 \big)\delta(t-t').
\end{equation}
根据随机微分方程理论，扩散系数定义为
\begin{equation}
D = \frac{2\gamma k_B T_w + \sigma^2}{2\gamma^2}.
\end{equation}
将其展开为两部分：
\begin{equation}
D = \frac{k_B T_w}{\gamma} + \frac{\sigma^2}{2\gamma^2}.
\end{equation}
第一项是标准的 Einstein 关系，描述由热噪声引起的扩散；第二项则是外部噪声的修正，说明附加的随机驱动能够显著增强系统的扩散强度。
若进一步引入迁移率 $\mu = 1/\gamma$，则可写为
\begin{equation}
D = \mu k_B T_w + \frac{\sigma^2 \mu^2}{2}.
\end{equation}\par
量纲分析表明，该公式在物理上自洽。非热噪声项 $\sigma^2/(2\gamma^2)$ 的单位确实与扩散系数相符，即 $\mathrm{m^2/s}$。  
在此基础上，概率流与熵产生率的公式可保持原有定义：
\begin{equation}
J(x,t) = \mu f(x,t)p(x,t) - D \partial_x p(x,t),
\end{equation}
\begin{equation}
\dot{\Sigma} = \frac{1}{D} \left\langle \left( \frac{J}{p} \right)^2 \right\rangle \geq \frac{\langle \dot{x} \rangle^2}{D}.
\end{equation}
与传统热噪声情形相比，此处的熵产生率界限受 $\sigma^2$ 修正后的扩散系数影响，从而在理论层面上与最新的熵产生下界理论（如 Leighton 和 Sivak 提出的 Jensen bound \cite{Leighton2024}）形成呼应。\par  
本节结果不仅为非平衡布朗动力学提供了更全面的刻画，还为实验上通过外场调控噪声强度进而控制扩散与熵产生提供了理论依据。

\chapter{理论模拟}

\section{布朗运动及 MSD 与时间 $t$ 的线性关系验证}

对于一个半径 $0.5~\mu\text{m}$ 的粒子，在 $20^\circ$C 水溶液中做布朗运动时，其轨迹如图所示：
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.9\textwidth]{trajectory.png}
  \caption{半径 $0.5~\mu$m 粒子的布朗运动轨迹示意}
  \label{fig:trajectory}
\end{figure}

对于多个半径 $0.5~\mu\text{m}$ 的粒子，在 $20^\circ$C 水溶液中做布朗运动时，其总 MSD 与时间满足：
\begin{align}
  \text{MSD}(t) &= 2Dt \quad &\text{(一维)} \\
  \text{MSD}(t) &= 4Dt \quad &\text{(二维)}
\end{align}

我们主要探究粒子在一维方向的运动特性。以其中 3 个粒子为例，其一维方向的位移随时间变化如图所示：

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.9\textwidth]{displacement.png}
  \caption{三颗粒子在一维方向的位移随时间变化}
  \label{fig:displacement}
\end{figure}

\subsection{噪声对布朗运动的影响}

若在溶液环境中引入白噪声电场力，其作用可通过附加一项随机力 $\xi(t)$ 表示。对于直径 $0.5~\mu\text{m}$ 的粒子，随机电场力振幅 $\sigma$ 的定义为
\begin{equation}
  \sigma = q \frac{V_0}{d},
\end{equation}
其中，$q$ 为粒子所带电荷量，$V_0$ 为电极两端所加电压，$d$ 为电极间距。实验中，$\sigma$ 的数量级约为 $10^{-14}$，$d = 0.02~\text{m}$，$q \approx 10^{-16}$，因此 $V_0$ 设置在 $1$--$10~\text{V}$ 范围内。

在该条件下，粒子的有效温度会升高，但其 $x$ 方向位移依旧表现出一维随机布朗运动的性质。
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.9\textwidth]{一维位移.png}
  \caption{一维情况下的粒子}
  \label{fig:一维位移}
\end{figure}

\section{朗之万方程数值模拟与等效温度}

布朗运动在一维情况下可由朗之万方程描述：
\begin{equation}
  m \frac{dv}{dt} = -\gamma v + \xi(t) + \zeta(t),
\end{equation}
其中，$\gamma$ 为摩擦系数，$\xi(t)$ 表示热噪声，$\zeta(t)$ 表示外加电噪声。根据能量均分定理，定义等效动能温度为
\begin{equation}
  T_{\text{eff}} = \frac{m \langle v^2 \rangle}{k_B},
\end{equation}
其中 $k_B$ 为玻尔兹曼常数，$m$ 为粒子质量，$\langle v^2 \rangle$ 为速度方差。

\section{不同 $\sigma$ 下的扩散系数拟合}

当引入噪声时，扩散系数随 $\sigma$ 的变化关系可表示为
\begin{equation}
  D = D_0 + k\sigma^2,
  \label{eq:D_sigma}
\end{equation}
其中 $D_0$ 为无外加噪声时的扩散系数，$k$ 为拟合系数。因此，$D$ 与 $\sigma$ 呈二次曲线关系。

\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.9\textwidth]{fit.png}
  \caption{不同噪声强度下扩散系数 $D$ 的拟合结果}
  \label{fig:fit}
\end{figure}


\chapter{装置设计}
\section{实验仪器与设计}
由于水平放置的样品容易受到重力作用，悬浮粒子会逐渐沉降至样品底部，进而受到附加阻力的影响，导致微球的布朗运动减弱，
不利于作为理想的实验对象\cite{einstein1905,dhont1996brownian}。\par
因此，本实验采用垂直放置样品的设计，以最大程度减小重力对粒子运动的干扰。垂直放置不仅能够更好地匹配显微镜的光学路径，
从而提升成像质量与分辨率，还能更准确地捕捉布朗粒子的运动轨迹。此外，该设计也便于电极的插入与固定，为后续加载噪声信号提供了实验条件。\par

在光源选择方面，本实验采用非相干光源作为照明。相比于相干光，非相干光源具有较宽的光谱范围和较低的相干性，可有效抑制干涉和衍射效应，
从而提升成像的均匀性与清晰度，更适合布朗粒子的观测需求\cite{goodman,mandel1995optical}。\par

对于噪声的引入，本实验利用信号发生器产生可控的电噪声信号。
通过调节其输出频率与幅度，可精确控制噪声特性，以适应不同实验条件\cite{horowitz1989art,schreiber1999electrical}。

实验所用主要仪器如下：
分辨率板为 USAF 1951；100$\times$ 物镜（SOPTOP，NA = 0.80，工作距离 2~mm，有限远校正）；
CCD 为海康机器人，分辨率 5472$\times$3648，像素间距 2.4~$\mu$m，20~fps；信号发生器型号为固纬 AFG-2225。
\begin{figure}[htbp]
    \centering
    % 每行 4 张
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{5.0ml微量离心管.jpg}
        \caption{5.0ml微量离心管}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{光学平台.jpg}
        \caption{光学平台}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{比色皿.jpg}
        \caption{比色皿与样品}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{微量进样器.jpg}
        \caption{微量进样器}
    \end{subfigure}

    % 第二行
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{分辨率板.jpg}
        \caption{分辨率板}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{去离子水.jpg}
        \caption{去离子水}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{无水乙醇.jpg}
        \caption{无水乙醇}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{甘油.jpg}
        \caption{甘油}
    \end{subfigure}

    % 第三行
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{100x物镜.jpg}
        \caption{100x物镜}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{非相干光源.jpg}
        \caption{非相干光源}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{夹具1.jpg}
        \caption{夹具}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{CCD.jpg}
        \caption{CCD}
    \end{subfigure}

    % 第四行
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{胶头滴管.jpg}
        \caption{胶头滴管}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{剪刀与铜片.jpg}
        \caption{剪刀与铜片}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{烧杯与量筒.jpg}
        \caption{烧杯与量筒}
    \end{subfigure}
    \begin{subfigure}{0.22\textwidth}
        \includegraphics[width=\linewidth]{信号发生器.jpg}
        \caption{信号发生器}
    \end{subfigure}

    \caption{实验仪器}
\end{figure}

\section{实验装置}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{完整实验装置.jpg}
    \caption{实验装置示意图}
    \label{fig:allsetup}
\end{figure}
\chapter{实验内容}

\section{实验操作}
\subsection{实验步骤}
1.按照图~\ref{fig:allsetup}搭建光路，其示意图如图~\ref{fig:sets}所示，开启 LED 光源，保证LED光经过聚光镜后均匀照射在比色皿（或分辨率板）上，
固定好LED，显微物镜，和CCD相机后，进行标定实验。
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{实验示意图.png}
    \caption{实验装置示意图}
    \label{fig:sets}
\end{figure} 
标定实验：首先将分辨率板放在夹具上，打开LED，将CCD放在物镜后适当位置，前后调整物镜以使分辨率板的图像变得清晰可见，如下图~\ref{fig:biaoding}
\begin{figure}[H]
    \centering
    % 每行 2 张
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{标定装置.jpg}
        \caption{装置图}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{标定.jpg}
        \caption{拍摄到的部分分辨率板}
    \end{subfigure}

    \caption{标定}
    \label{fig:biaoding}
\end{figure}
2.配制适当浓度的不同直径（0.5~$\mu$m，2~$\mu$m，5~$\mu$m）、不同液体粘度（甘油与去离子水的混合）的聚苯乙烯（PS）微球。\par
剪取两片铜片作为电极，使用无水乙醇清洗后晾干。\par
3.将溶液加入比色皿中，放在夹具上静置 0.5--1 h。\\ 
\quad \textbullet\ 对于验证布朗运动的实验，无需插入电极、连接信号发生器等操作。 \\
\quad \textbullet\ 对于验证等效温度与扩散系数的拟合实验，插入电极并连接信号发生器，保持电极平行紧贴两侧。\par
4.开启 LED，观察 PS 微球，待稳定时收集数据（对于验证等效温度与扩散系数的拟合实验，在稳定后需要控制信号发生器
依次加载0--10V的电压，然后收集数据）。\par
5.将比色皿取下，拍摄背景图片。\par
6.进行数据处理，计算相关物理量。\par
\subsection{数据处理}
首先，使用附录~\ref{code:searchforparticles}的python代码对采集到的视频进行处理，提取出每一帧图像，并使用trackpy库对每一帧图像进行粒子检测，得到每一帧中所有粒子的坐标信息。\par
接着，对所有帧中的粒子进行追踪，得到每个粒子的轨迹信息。然后使用自定义的过滤函数对轨迹数据进行过滤，去除静止不动的粒子和短轨迹粒子，得到干净的轨迹数据。 \par
最后，使用附录~\ref{code:calculate}计算每个粒子的均方位移（MSD），并对所有粒子的MSD进行平均，得到最终的MSD数据。对MSD数据进行拟合得到扩散系数等物理量。\par
\section{MSD与时间t的线性关系验证}
首先根据前面处理得到的MSD数据绘制MSD与时间t的关系图，并对数据进行线性拟合(只取0-1s的数据进行拟合，具体的原因详见附录：有效拟合区间的选取与图~\ref{fig:let1}。对于本实验可以得到只有在0-1s内才是误差可接受的范围。后续没有特殊说明时，拟合MSD均取0-1s)，
验证MSD与时间t的线性关系。 \par
\subsection{不同直径粒子的均方位移（MSD）}
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.9\textwidth]{实验数据拟合1.jpg}
  \caption{不同粒径的实验MSD与拟合曲线以及局部放大图，以及扩散系数}
  \label{fig:fit1}
\end{figure}
得到上面的拟合数据后，可以将实验所得的扩散系数与理论值进行对比。根据
\begin{equation}
    D = \frac{k_B T}{6 \pi \eta r},
\end{equation}
在其他条件不变的情况下，粒子直径越大，其扩散系数越小。通过对不同粒径布朗粒子在前段较稳定的 MSD 进行拟合，可以发现三种粒子的扩散系数满足
\[
    D_{0.5} > D_{2.0} > D_{5.0}.
\]
下面是实验计算得到的MSD与理论值的对比：
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.9\textwidth]{对比1.jpg}
  \caption{不同粒径粒子的MSD对比}
  \label{fig:fitall1}
\end{figure}
\newpage
\subsection{不同粒子直径，不同粘度溶液中的均方位移（MSD）}
我们分别配制了不同比例（）的甘油与去离子水混合溶液，测量了不同粘度下2~$\mu$m和0.5~$\mu$m的MSD，并对数据进行拟合：\par
\begin{figure}[H]
    \centering
    % 每行 2 张
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{实验数据拟合2.jpg}
        \caption{2~$\mu$m的粒子在不同粘度溶液中的MSD}
        \label{fig:fit2}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{实验数据拟合3.jpg}
        \caption{0.5~$\mu$m的粒子在不同粘度溶液中的MSD}
        \label{fig:fit3}
    \end{subfigure}

    \caption{实验数据拟合}
\end{figure}
与前面类似，依旧可以得到不同粘度下的扩散系数，并与理论值进行对比：
\begin{figure}[H]
    \centering
    % 每行 2 张
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{对比2.jpg}
        \caption{2~$\mu$m的粒子的MSD对比}
        \label{fig:fitall2}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{对比3.jpg}
        \caption{0.5~$\mu$m粒子的MSD对比}
        \label{fig:fitall3}
    \end{subfigure}

    \caption{实验数据拟合}
\end{figure}

\section{计算等效温度与扩散系数的拟合}
对于加载不同噪声强度的实验，我们以0.5~$\mu$m的粒子为例，
0.5微米ps球在不同电压下经过30秒布朗运动的x方向位移测算，得到x方向MSD数据如图所示，可见整体上随着电压增大，小球的总体MSD呈现增大趋势。分别以0v和10v为例，它们的粒子x方向位移随时间t的关系为：\par
\begin{figure}[H]
    \centering
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{粒子1.jpg}
        \caption{0.5$\mu$m无噪声}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{粒子2.jpg}
        \caption{0.5~$\mu$m10v噪声}
    \end{subfigure}

    \caption{实验数据拟合}
\end{figure}
在实验中，我们分别设置噪声强度为0--10v，电压间隔为2v，测量了不同噪声强度下0.5~$\mu$m粒子的MSD，如图所示：\par
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{不同噪声强度下的MSD.jpg}
    \caption{不同噪声强度下的MSD}
    \label{fig:msdnoise}
\end{figure}
分别对这些 MSD 取稳定的前 30 个点进行数据拟合，即$\text{MSD} = 2Dt$
的线性拟合，得到斜率之间的关系如图所示。
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{不同噪声强度下的扩散系数.jpg}
    \caption{不同噪声强度下的扩散系数}
    \label{fig:diffusionnoise}
\end{figure}
汇总扩散系数D拟合结果,同时根据\eqref{eq:Teff}我们也可以计算有效温度随电压的变化：
\begin{table}[H]
    \centering
    \caption{不同电压下的扩散系数对比}
    \begin{tabular}{cccc}
        \toprule
        电压 & $D$ 拟合值 (m$^2$/s) & $D$ 理论值 (m$^2$/s) & 误差 (\%) \\
        \midrule
        0V  & $9.885 \times 10^{-13}$ & $9.871 \times 10^{-13}$ & 0.14 \\
        2V  & $9.994 \times 10^{-13}$ & $9.871 \times 10^{-13}$ & 1.24 \\
        4V  & $1.010 \times 10^{-12}$ & $9.871 \times 10^{-13}$ & 2.36 \\
        6V  & $1.020 \times 10^{-12}$ & $9.871 \times 10^{-13}$ & 3.38 \\
        8V  & $1.051 \times 10^{-12}$ & $9.871 \times 10^{-13}$ & 6.52 \\
        10V & $1.075 \times 10^{-12}$ & $9.871 \times 10^{-13}$ & 8.92 \\
        \bottomrule
    \end{tabular}
\end{table}
\begin{table}[H]
    \centering
    \caption{不同电压下的动能温度与温升}
    \begin{tabular}{ccc}
        \toprule
        电压 (V) & $T_{\text{kin}}$ (K) & $\Delta T$ (K) \\
        \midrule
        0  & 300.42 & 0.42 \\
        2  & 303.73 & 3.73 \\
        4  & 306.95 & 6.95 \\
        6  & 309.99 & 9.99 \\
        8  & 319.41 & 19.41 \\
        10 & 326.71 & 26.71 \\
        \bottomrule
    \end{tabular}
\end{table}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{温度.jpg}
    \caption{有效温度随电压的变化趋势}
    \label{fig:trends}
\end{figure}
对于有效温度：\\
理论斜率：$a_{\text{theory}} = 2.596 \times 10^{-1} \ \text{K}/\text{V}^2$ \\ 
实验斜率：$a_{\text{experimental}} = 2.546 \times 10^{-1} \ \text{K}/\text{V}^2$ \\ 
相对误差：$= 1.90\%$\par
根据公式\eqref{eq:D_sigma}，D和V之间应该满足二次关系。对D和V作图，进行$D = D_0 + kV^2$的二次拟合，得到拟合后的参数。
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{二次拟合.jpg}
    \caption{扩散系数随电压的二次函数关系}
    \label{fig:fit2V}
\end{figure}
我们可以得知
\begin{equation}
    D = D_0 + \frac{\sigma^2}{(2\gamma)^2},
\end{equation}
又有
\begin{equation}
    \sigma = \frac{|q|}{d_0}\,\alpha V,
\end{equation}
其中$\gamma = 6 \pi \eta r$是摩擦系数， $\alpha$ 是实验中用于修正的参数，即小球由于种种原因没有感受到理想状态下的电压。  
因此，真正的 $D\!-\!V^2$ 参数应为
\begin{equation}
    \frac{q^2 \alpha^2}{2 \gamma^2 d_0^2}.
\end{equation}

代入数据，其中 $q = 1.6\times 10^{-17}$（100 个电荷），$\alpha = 13\%$，$d_0 = 1.2\,\mathrm{cm}$。  
二次函数的拟合参数为 $8.648\times 10^{-16}$，与实际值 $8.516\times 10^{-16}$ 对比，  
最终误差为 $1.6\%$。
\newpage
\section{注意事项}
（1）每次使用完微量移液器，比色皿和电极片需要用无水乙醇清洗干净，防止污染。\par
（2）实验过程中，不要随意走动或在试验台上进行其他操作，尽量避免振动和气流对比色皿的影响。\par
（3）待每次采集微球的运动数据后，需尽快移走比色皿并保持其他部分装置不动和CCD曝光时间相同，尽快拍摄背景图片 \par
（4）在使用信号发生器加载不同幅度的噪声时，需要确保电极是紧贴着内壁两侧。且加载电压要从0v逐渐增加到10v，而不能从10v逐渐降低电压
至0v，防止微球先收到高电压的噪声未经静置而影响后续MSD的计算。\par
（5）在进行分辨率板的标定实验后，需要固定其他剩余的实验装置，尤其是100x物镜和CCD的相对位置，以保证标定分辨率板后的像素尺寸不会发生变化。\par
\chapter{误差分析}
\section{误差来源分析}
（1）在进行分辨率板的标定实验中，虽然我们确定了当分辨率板位于物镜工作平面时，相机每个像素对应的距离，但是在将分辨率板换为比色皿时，
由于比色皿的厚度与分辨率板的厚度并不相同，且无法保证视野内观察到比色皿中的微球。此时，需要前后稍微移动物镜来使视野内有我们想要观察的PS微球。 \par
（2）配制甘油与水的混合比例时，取一定量的水和甘油时会引入误差。\par
（3）微球的浓度分布也会造成误差：微球浓度过高可能导致重叠或遮挡，浓度过低则统计样本不足；溶液未充分混合或存在团聚会影响扩散行为的代表性。\par
（4）由于电极的宽度只有2mm，因此电极加载的电场会由于边缘效应而不均匀，电极未完全平行或紧贴比色皿壁，导致电场分布不均匀，影响等效温度实验的电压控制效果。\par
（5）采集的粒子数量和时间有限，统计平均值可能与真实值有偏差。我们计算的物理量是基于统计平均的，因此对于有限的数据量，会由于随机性等产生误差。\par
（6）不同的粒子识别算法与追踪算法也会带来误差，而且在图像中，粒子边缘模糊或多个粒子重叠会导致识别错误。\par

\chapter{结论与展望}
\section{实验结论}
本实验构建了一个由外加可控电噪声驱动的布朗粒子系统，实现了对于外加电噪声的完全调控，为研究非平衡统计物理中的能量耗散与熵产生提供了实验平台。实验内容主要围绕以下几个方面展开：\\

首先，在理论层面，我们基于朗之万方程推导了外部噪声作用下的有效动能温度与扩散系数修正关系。结果表明，外加随机力等效地提高了布朗粒子的动能温度，其贡献量与噪声强度的平方成正比，与阻尼系数成反比。
这一结论不仅与已有实验研究相符 \cite{Martinez2013,Roldan2014}，也为解释实验中温度随电压增大的趋势提供了理论依据。同时，修正后的扩散系数公式揭示了外部噪声对系统弛豫行为和熵产生率下界的重要影响 \cite{Leighton2024}。\par

其次，在实验操作方面，我们搭建了垂直放置样品的观测平台，可以对更大的微粒进行布朗运动等相关的研究而不会受到容器壁对微粒的干扰，
并采用非相干光源与高倍显微镜结合 CCD 成像的方法，对微球的布朗运动进行了精确测量。通过信号发生器引入 0--10V 的可调电噪声，实现了对非平衡驱动强度的连续调控。\par

在实验结果方面：\par
\begin{itemize}
    \item 对不同粒径粒子与不同粘度环境的 MSD 数据拟合表明，实验测得的扩散系数与理论值符合良好，验证了 $D \propto 1/r$ 与 $D \propto 1/\eta$ 的依赖关系。
    \item 在外加噪声作用下，0.5~$\mu$m 粒子的 MSD 随电压升高整体呈增大趋势。对 MSD 的前 30 个点进行线性拟合，得到了不同电压下的扩散系数，并计算了相应的动能温度。
    \item 扩散系数 $D$ 与电压平方 $V^2$ 的关系符合二次函数形式，拟合参数与理论值的相对误差为 $1.6\%$，表明理论模型与实验观测高度一致。
    \item 动能温度的实验斜率与理论斜率的差异仅为 $1.9\%$，进一步验证了外部随机驱动等效加热效应的可靠性。
\end{itemize}

综上所述，本实验不仅在定性上验证了外部噪声对布朗粒子动力学的调控作用，也在定量上通过 MSD 与扩散系数的拟合展示了理论与实验的高度一致性。这些结果为深入理解非平衡体系中的温度涌现机制、扩散行为重构以及熵产生过程提供了有力的实验支撑，
同时也展示了基于电噪声驱动的布朗实验平台在非平衡统计物理研究中的应用潜力。

\section{未来展望}
本实验通过构建由外加可控电噪声驱动的布朗粒子系统，验证了外部随机力对布朗粒子扩散动力学及动能温度的显著影响，并为研究非平衡统计物理中的耗散与熵产生提供了可靠的实验平台。
在此基础上，未来的研究可以从以下几个方向进一步拓展：\par

首先，在理论方面，可进一步探讨不同类型噪声（如有色噪声、非高斯噪声、相关噪声）对布朗动力学的影响，分析其在扩散系数修正、有效温度涨落以及熵产生率中的作用，从而丰富和拓展非平衡态下随机热力学的理论框架。
同时，可以结合数值模拟与随机过程理论，研究高维体系和多粒子耦合条件下的能量耗散机制。\par

其次，在实验层面，可通过引入更高分辨率的测量手段（如高速相机、三维轨迹跟踪技术），精确刻画粒子的瞬时速度分布与轨迹涨落，以验证理论模型在更细尺度下的适用性。

\subsection{离轴全息}
我们计划在实验层面引入更高分辨率的测量手段————离轴全息。目前我们已经实现了如图~\ref{fig:lizhouholo}的离轴全息光路搭建。\par
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{expreiment.jpg}
    \caption{离轴全息实验装置}
    \label{fig:lizhouholo}
\end{figure}
\subsection{离轴全息的原理与重建}
离轴全息（Off-axis Holography）是一种通过在记录过程中引入参考光与物光的倾斜干涉来实现像分离的数字全息方法。
其核心思想是在探测面上形成包含物光波前信息的干涉条纹，并通过空间频域滤波提取所需的复振幅信息，
从而实现三维波场的数值重建。下面简要地给出原理，更多与全息和计算全息相关的内容可参考\cite{goodman,shuzi1,shuzi2}
\subsubsection{原理}
设物光复振幅为 $O(x,y)$，参考光复振幅为
\begin{equation}
R(x,y) = A_r e^{i 2\pi (f_x x + f_y y)},
\end{equation}
其中 $A_r$ 为参考光幅值，$f_x, f_y$ 为由倾斜角决定的空间频率分量。干涉强度分布可表示为
\begin{equation}
I(x,y) = |O(x,y) + R(x,y)|^2 = |O(x,y)|^2 + |A_r|^2 + O(x,y) R^*(x,y) + O^*(x,y) R(x,y),
\end{equation}
其中第三项和第四项分别为携带物光复振幅信息的正、共轭像调制项。

由于参考光与物光具有一定倾斜角，$O(x,y) R^*(x,y)$ 和 $O^*(x,y) R(x,y)$ 在频域中被移至原点两侧，不同于零频项 $|O|^2 + |A_r|^2$，从而可在频谱平面中利用带通滤波选取目标像的频谱区域，抑制共轭像与零级像的干扰。
其示意图如图~\ref{fig:lizhoushiyi}所示：
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{离轴示意图.jpg}
    \caption{离轴全息示意图}
    \label{fig:lizhoushiyi}
\end{figure}
\subsubsection{重建}
首先对干涉图 $I(x,y)$ 进行二维傅里叶变换：
\begin{equation}
\mathcal{F}\{I(x,y)\} = \mathcal{F}\{|O|^2 + |A_r|^2\} + \mathcal{F}\{O R^*\} + \mathcal{F}\{O^* R\},
\end{equation}
通过滤波保留所需的 $\mathcal{F}\{O R^*\}$ 项并进行逆傅里叶变换，可得到物光的复振幅分布（除去已知参考光相位）：
\begin{equation}
O'(x,y) = \mathcal{F}^{-1} \left[ \mathcal{F}\{I(x,y)\} \cdot H(f_x,f_y) \right],
\end{equation}
其中 $H(f_x,f_y)$ 为空间频域带通滤波器。若需将物平面重构到某一距离 $z$，可利用菲涅尔衍射积分进行数值传播：
\begin{equation}
U(x,y;z) = \mathcal{F}^{-1} \left\{ \mathcal{F}[O'(x,y)] \cdot e^{i 2\pi z \sqrt{\frac{1}{\lambda^2} - f_x^2 - f_y^2}} \right\},
\end{equation}
其中 $\lambda$ 为波长，$f_x,f_y$ 为空间频率坐标。

该方法通过频域分离实现单次拍摄下的相位重建，具有结构简单、计算高效、适应性强等优点，广泛应用于显微成像、位相测量及动态过程监测等领域。
\subsection{目前的成果}
目前我们已经可以拍摄分辨率板的离轴全息图并通过算法重建并计算物体距离收集位置的距离z，下面是我们拍摄到的一些全息图：
\begin{figure}[H]
    \centering
    % 每行 3 张
    \begin{subfigure}{0.3\textwidth}
        \includegraphics[width=\linewidth]{lizhou1.jpg}
        \caption{分辨率板1}
    \end{subfigure}
    \begin{subfigure}{0.3\textwidth}
        \includegraphics[width=\linewidth]{lizhou2.jpg}
        \caption{分辨率板2}
    \end{subfigure}
    \begin{subfigure}{0.3\textwidth}
        \includegraphics[width=\linewidth]{lizhou3.jpg}
        \caption{分辨率板3}
    \end{subfigure}

    \caption{拍摄到的全息图}
\end{figure}
通过算法重建并确定z的过程如下图所示：
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{离轴1分辨率板.jpg}
    \caption{重建1}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{离轴2分辨率板.jpg}
    \caption{重建2}
\end{figure}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{离轴3分辨率板.jpg}
    \caption{重建3}
\end{figure}
可以看到已经能够根据全息图进行重建，但是目前的光路无法达到重建我们实验中想要观察的0.5~5$\mu $m的透明微球，因此我们后续的工作方向就是
搭建可以实现显微作用的离轴全息光路并设计优化目前确定z的方法。
\chapter{附录}
\section{有效拟合区间的选取（MSD 与延迟时间 $\Delta t$ 的关系分析）}
\subsection*{一、分析目的}

研究粒子运动的均方位移（Mean Squared Displacement, MSD）随延迟时间 $\Delta t$ 的变化关系，并结合理论误差模型评估测量结果的可靠性。通过绘制 MSD 曲线及其误差带，确定有效分析的时间范围（即统计误差小于 10\% 的区间），为后续扩散行为分析提供依据。

\subsection*{二、理论原理}
\subsubsection*{1. 均方位移（MSD）}
均方位移是描述粒子扩散行为的重要物理量，定义为：
\[
\text{MSD}(k) = \langle |\vec{r}(t + k\Delta t) - \vec{r}(t)|^2 \rangle
\]
其中：
\begin{itemize}
    \item $k$：延迟步数（lag time）
    \item $\Delta t$：单步时间间隔
    \item $\vec{r}(t)$：粒子在时间 $t$ 的位置
    \item $\langle \cdot \rangle$：对所有起始时间 $t$ 的平均
\end{itemize}
在正常扩散中，MSD 与 $\Delta t$ 呈线性关系：
\[
\text{MSD} \propto \Delta t
\]
\subsubsection*{2. 相对误差模型}
由于有限轨迹长度，MSD 的估计存在统计误差。定义 $\rho_k = \text{MSD}(k)$，其相对标准偏差为：
\[
\frac{\Delta \rho_k}{\langle \rho_k \rangle}
\]
根据相关文献内的理论推导\cite{qian1991spt}，该比值可由以下分段函数估算：
\[
\frac{\Delta \rho_k^2}{\langle \rho_k \rangle^2} =
\begin{cases}
\displaystyle \frac{4(N-k)k^2 + 2(N-k) + k - k^3}{6k(N-k)^2}, & k < \tfrac{N}{2} \\[2ex]
\displaystyle 1 + \frac{(N-k)^3 - 4(N-k)^2 k + 5k - N}{6k^2(N-k)}, & k \geq \tfrac{N}{2},\; k < N
\end{cases}
\]
其中 $N$ 为轨迹的总帧数。

\subsubsection*{3. 有效分析范围}

设定阈值：当 
\[
\frac{\Delta \rho_k}{\langle \rho_k \rangle} < 10\%
\] 
时，认为统计误差可接受。通过计算该比值随 $k$ 的变化，确定最大有效延迟步数 $k_{\text{max}}$，对应 $\Delta t_{\text{max}}$。

\subsection*{三、数据处理流程}

\subsubsection*{1. 数据读取}

从 CSV 文件 \texttt{msd\_curve.csv} 中读取两列数据：
\begin{itemize}
    \item \texttt{delta\_t}：延迟时间 $\Delta t$（单位：秒）
    \item \texttt{MSD}：对应延迟时间下的均方位移（单位：$\mu m^2$）
\end{itemize}

\subsubsection*{2. 参数设置}

\begin{itemize}
    \item 总帧数 $N = \text{len}(\text{delta\_t})$
    \item 延迟步数 $k = 1, 2, \dots, N-1$
\end{itemize}

\subsubsection*{3. 误差比计算}

对每个 $k$ 计算 $\frac{\Delta \rho_k}{\langle \rho_k \rangle}$，并用于构建误差带：
\[
\text{上界： } \text{MSD}(k) \times \left(1 + \frac{\Delta \rho_k}{\langle \rho_k \rangle}\right)
\]
\[
\text{下界： } \text{MSD}(k) \times \left(1 - \frac{\Delta \rho_k}{\langle \rho_k \rangle}\right)
\]

\subsubsection*{4. 确定有效范围}

找到第一个满足 $\frac{\Delta \rho_k}{\langle \rho_k \rangle} \geq 0.1$ 的 $k$ 值，对应 $\Delta t$ 作为红色虚线标注。

通过上述计算模拟得到的图像可以发现：当 
\[
\frac{\Delta \rho_k}{\langle \rho_k \rangle} < 10\%
\]
时，曲线的线性关系较好（误差可以接受）的位置可以作为有效拟合区间。在本实验中我们取有效拟合区间为前 20 个数据点，即 $\Delta t \approx 1 \ \text{s}$ 附近。

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{取1.jpg}
    \caption{MSD与延迟时间的关系}
    \label{fig:let1}
\end{figure}

\section{人员分工}
\renewcommand{\arraystretch}{1.3} % 表格行距调整

\begin{tabularx}{\textwidth}{>{\bfseries}l X}
\toprule
队员 & 分工 \\
\midrule
队员一 & 负责实验数据采集，实验报告的撰写等。 \\
队员二 & 负责热学相关部分原理的推导和微球布朗运动的模拟等。 \\
队员三 & 负责制作ppt和实验采集，查阅文献等。 \\
队员四 & 负责后期数据处理,误差分析，查阅文献等。 \\
\bottomrule
\end{tabularx}

\section{部分代码展示}
\begin{lstlisting}[language=Python, caption=有效拟合区间的选取, label=code:calculate1]
def calculate_ratio(k, N):
    if k < N / 2:
        return (4 * (N - k) * k**2 + 2 * (N - k) + k - k**3) / (6 * k * (N - k)**2)
    else:
        return 1 + ((N - k)**3 - 4 * (N - k)**2 * k + 5 * k - N) / (6 * k**2 * (N - k))
df = pd.read_csv(r'E:\26day\500nm\msd_curve.csv')

# 提取Δt和MSD数据
delta_t = df['time_lag (s)'].values
msd_values = df['ensemble_MSD (m^2)'].values
N = len(delta_t)
k_values = np.arange(1, N)  # 1, 2, ..., N-1

# 截取前 N-1 个数据点用于绘图（因为 ratio 只能算到 N-1）
delta_t_plot = delta_t[:N-1]
msd_plot = msd_values[:N-1]

# 计算 ratio 值
ratio_values = [calculate_ratio(k, N) for k in k_values]
ratio_array = np.array(ratio_values)

# 计算误差带
error_band_upper = msd_plot * (1 + ratio_array)
error_band_lower = msd_plot * (1 - ratio_array)

# 找到第一个 ratio >= 10% 的位置
threshold_index = np.argmax(ratio_array >= 0.1)
threshold_dt = delta_t_plot[threshold_index]
\end{lstlisting}

\begin{lstlisting}[language=Python, caption=检测微球, label=code:searchforparticles]
def filter_stationary_particles(trajectories, max_displacement=2.0, min_frames=10):
    """
    过滤静止不动的粒子（CCD灰尘）
    
    参数:
    trajectories: 轨迹数据
    max_displacement: 最大允许位移（像素），小于此值认为是静止粒子
    min_frames: 最小帧数，少于这个帧数的轨迹直接过滤
    """
    
    filtered_trajectories = []
    stationary_count = 0
    short_trajectory_count = 0
    
    for particle_id, group in trajectories.groupby('particle'):
        # 过滤短轨迹
        if len(group) < min_frames:
            short_trajectory_count += 1
            continue
            
        # 计算粒子的总位移
        start_frame = group['frame'].min()
        end_frame = group['frame'].max()
        
        start_pos = group[group['frame'] == start_frame][['x', 'y']].values[0]
        end_pos = group[group['frame'] == end_frame][['x', 'y']].values[0]
        
        total_displacement = np.sqrt(np.sum((end_pos - start_pos) ** 2))
        
        # 计算RMS位移
        mean_x = group['x'].mean()
        mean_y = group['y'].mean()
        rms_displacement = np.sqrt(np.mean((group['x'] - mean_x) ** 2 + (group['y'] - mean_y) ** 2))
        
        # 过滤静止粒子
        if total_displacement < max_displacement and rms_displacement < max_displacement:
            stationary_count += 1
            continue
        
        # 保留非静止粒子
        filtered_trajectories.append(group)
    
    if filtered_trajectories:
        filtered_df = pd.concat(filtered_trajectories, ignore_index=True)
    else:
        filtered_df = pd.DataFrame(columns=trajectories.columns)
    
    print(f"过滤结果:")
    print(f"  总粒子数: {trajectories['particle'].nunique()}")
    print(f"  静止粒子数: {stationary_count}")
    print(f"  短轨迹粒子数: {short_trajectory_count}")
    print(f"  有效粒子数: {filtered_df['particle'].nunique()}")
    
    return filtered_DataFrame

def batch_detect_particles(frames, params):
    """批量检测所有帧中的粒子"""
    all_features = []
    
    print("开始批量检测粒子...")
    for i, frame in enumerate(frames):
        # 使用trackpy检测粒子
        features = tp.locate(frame, 
                            diameter=params['diameter'],
                            minmass=params['minmass'],
                            separation=params['separation'],
                            noise_size=params['noise_size'],
                            invert=params['invert'])
        
        # 添加帧编号信息
        features['frame'] = i
        all_features.append(features)
        
        if (i + 1) % 50 == 0:
            print(f"已处理 {i + 1}/{len(frames)} 帧，当前帧检测到 {len(features)} 个粒子")
    
    # 合并所有检测结果
    combined_features = pd.concat(all_features, ignore_index=True)
    print(f"\n总共检测到 {len(combined_features)} 个粒子检测结果")
    return combined_features
\end{lstlisting}
首先使用上面的代码进行粒子检测和过滤，得到干净的粒子轨迹数据。然后使用下面的代码进行粒子跟踪、可视化和统计分析。\\
\begin{lstlisting}[language=Python, caption=可视化与计算, label=code:calculate]
def track_particles(features_df, search_range=50, memory=5):
    """跟踪粒子运动轨迹"""
    print("开始粒子跟踪...")
    
    # 使用trackpy进行粒子跟踪
    trajectories = tp.link(features_df, 
                          search_range=search_range, 
                          memory=memory,
                          neighbor_strategy='KDTree')
    
    # 计算每个轨迹的粒子数量
    particle_counts = trajectories['particle'].value_counts()
    
    print(f"跟踪完成！")
    print(f"总共跟踪到 {len(particle_counts)} 个独立粒子")
    print(f"轨迹长度统计:")
    print(f"最长轨迹: {particle_counts.max()} 帧")
    print(f"最短轨迹: {particle_counts.min()} 帧")
    print(f"平均轨迹长度: {particle_counts.mean():.2f} 帧")
    
    return trajectories

def visualize_particle_movement(trajectories):
    """可视化粒子运动轨迹"""
    plt.figure(figsize=(12, 10))
    
    # 为每个粒子分配颜色
    particle_ids = trajectories['particle'].unique()
    colors = plt.cm.viridis(np.linspace(0, 1, len(particle_ids)))
    
    for i, particle_id in enumerate(particle_ids):
        group = trajectories[trajectories['particle'] == particle_id]
        if len(group) > 5:  # 只显示有足够数据的轨迹
            plt.plot(group['x'], group['y'], 'o-', 
                    markersize=2, linewidth=1, alpha=0.7, 
                    color=colors[i], label=f'粒子 {particle_id}')
    
    plt.title('粒子运动轨迹', fontsize=16, fontweight='bold')
    plt.xlabel('X坐标 (像素)', fontsize=12)
    plt.ylabel('Y坐标 (像素)', fontsize=12)
    plt.grid(True, alpha=0.3)
    plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')
    plt.tight_layout()
    plt.show()

def calculate_basic_statistics(trajectories):
    """计算基本统计信息"""
    print("\n轨迹统计信息:")
    print("=" * 40)
    
    # 轨迹长度统计
    trajectory_lengths = trajectories.groupby('particle').size()
    print(f"平均轨迹长度: {trajectory_lengths.mean():.2f} 帧")
    print(f"最长轨迹: {trajectory_lengths.max()} 帧")
    print(f"最短轨迹: {trajectory_lengths.min()} 帧")
    
    # 位移统计
    displacements = []
    for particle_id, group in trajectories.groupby('particle'):
        if len(group) > 1:
            start_pos = group[group['frame'] == group['frame'].min()][['x', 'y']].values[0]
            end_pos = group[group['frame'] == group['frame'].max()][['x', 'y']].values[0]
            displacement = np.sqrt(np.sum((end_pos - start_pos) ** 2))
            displacements.append(displacement)
    
    if displacements:
        print(f"平均位移: {np.mean(displacements):.2f} 像素")
        print(f"最大位移: {np.max(displacements):.2f} 像素")
        print(f"最小位移: {np.min(displacements):.2f} 像素")
    
    print(f"总粒子数: {trajectories['particle'].nunique()}")
    print(f"总数据点: {len(trajectories)}")
\end{lstlisting}

\section{实验数据}
\begin{figure}[H]
    \centering
    % 每行 2 张
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{不同比例.png}
        \caption{甘油与水不同比例}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{不同电压.png}
        \caption{加载不同电压}
    \end{subfigure}

    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{不同波形.png}
        \caption{加载不同波形}
    \end{subfigure}
    \begin{subfigure}{0.45\textwidth}
        \includegraphics[width=\linewidth]{不同粒子直径.png}
        \caption{不同粒子直径}
    \end{subfigure}

    \caption{实验相关数据}
\end{figure}
\begin{figure}[H]
    \centering
    % 每行 3 张
    \begin{subfigure}{0.3\textwidth}
        \includegraphics[width=\linewidth]{0.5um.png}
        \caption{0.5~$\mu$m粒子}
    \end{subfigure}
    \begin{subfigure}{0.3\textwidth}
        \includegraphics[width=\linewidth]{2um.png}
        \caption{2.0~$\mu$m粒子}
    \end{subfigure}
    \begin{subfigure}{0.3\textwidth}
        \includegraphics[width=\linewidth]{5um.png}
        \caption{5.0~$\mu$m粒子}
    \end{subfigure}

    \caption{不同直径粒子拍摄图（已转为灰度图）}
\end{figure}

\addcontentsline{toc}{chapter}{参考文献} % 手动加到目录
\bibliographystyle{plain}
\bibliography{refs}
\end{document}
